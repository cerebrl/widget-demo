import{SvelteComponent as t,init as e,safe_not_equal as r,empty as n,insert as o,group_outros as s,transition_out as i,check_outros as m,transition_in as l,detach as $,noop as p,subscribe as f,create_component as a,space as u,mount_component as c,destroy_component as g,element as d,attr as y,binding_callbacks as w,bind as x,add_flush_callback as j}from"../../../node_modules/svelte/internal/index.js";import _ from"../components/primitives/alert/alert.js";import E from"../components/primitives/button/button.js";import v from"../components/_utilities/locale-strings.js";import{mapStepToStage as h}from"./_utilities/map-stage.utilities.js";import b from"../components/primitives/spinner/spinner.js";function S(t){let e,r,n,s;return e=new _({props:{type:"error",$$slots:{default:[M]},$$scope:{ctx:t}}}),n=new E({props:{style:"secondary",onClick:t[4],$$slots:{default:[N]},$$scope:{ctx:t}}}),{c(){a(e.$$.fragment),r=u(),a(n.$$.fragment)},m(t,i){c(e,t,i),o(t,r,i),c(n,t,i),s=!0},p(t,r){const o={};64&r&&(o.$$scope={dirty:r,ctx:t}),e.$set(o);const s={};64&r&&(s.$$scope={dirty:r,ctx:t}),n.$set(s)},i(t){s||(l(e.$$.fragment,t),l(n.$$.fragment,t),s=!0)},o(t){i(e.$$.fragment,t),i(n.$$.fragment,t),s=!1},d(t){g(e,t),t&&$(r),g(n,t)}}}function k(t){let e,r,n;return r=new b({props:{colorClass:"tw_text-primary-light",layoutClasses:"tw_h-28 tw_w-28"}}),{c(){e=d("div"),a(r.$$.fragment),y(e,"class","tw_text-center tw_w-full tw_py-4")},m(t,s){o(t,e,s),c(r,e,null),n=!0},p:p,i(t){n||(l(r.$$.fragment,t),n=!0)},o(t){i(r.$$.fragment,t),n=!1},d(t){t&&$(e),g(r)}}}function C(t){let e,r,p,f;function u(e){t[5](e)}var d=h(t[2].step);function y(t){let e={failureMessage:t[2].error?.message,loading:t[2].loading,submitForm:t[3],step:t[2].step};return void 0!==t[0]&&(e.formEl=t[0]),{props:e}}return d&&(e=new d(y(t)),w.push((()=>x(e,"formEl",u)))),{c(){e&&a(e.$$.fragment),p=n()},m(t,r){e&&c(e,t,r),o(t,p,r),f=!0},p(t,n){const o={};if(4&n&&(o.failureMessage=t[2].error?.message),4&n&&(o.loading=t[2].loading),4&n&&(o.step=t[2].step),!r&&1&n&&(r=!0,o.formEl=t[0],j((()=>r=!1))),d!==(d=h(t[2].step))){if(e){s();const t=e;i(t.$$.fragment,1,0,(()=>{g(t,1)})),m()}d?(e=new d(y(t)),w.push((()=>x(e,"formEl",u))),a(e.$$.fragment),l(e.$$.fragment,1),c(e,p.parentNode,p)):e=null}else d&&e.$set(o)},i(t){f||(e&&l(e.$$.fragment,t),f=!0)},o(t){e&&i(e.$$.fragment,t),f=!1},d(t){t&&$(p),e&&g(e,t)}}}function M(t){let e,r;return e=new v({props:{html:!0,key:"unrecoverableError"}}),{c(){a(e.$$.fragment)},m(t,n){c(e,t,n),r=!0},p:p,i(t){r||(l(e.$$.fragment,t),r=!0)},o(t){i(e.$$.fragment,t),r=!1},d(t){g(e,t)}}}function N(t){let e,r;return e=new v({props:{key:"tryAgain"}}),{c(){a(e.$$.fragment)},m(t,n){c(e,t,n),r=!0},p:p,i(t){r||(l(e.$$.fragment,t),r=!0)},o(t){i(e.$$.fragment,t),r=!1},d(t){g(e,t)}}}function A(t){let e,r,p,f;const a=[C,k,S],u=[];function c(t,e){return t[2]?.completed?t[2]?.successful?1:2:0}return e=c(t),r=u[e]=a[e](t),{c(){r.c(),p=n()},m(t,r){u[e].m(t,r),o(t,p,r),f=!0},p(t,[n]){let o=e;e=c(t),e===o?u[e].p(t,n):(s(),i(u[o],1,1,(()=>{u[o]=null})),m(),r=u[e],r?r.p(t,n):(r=u[e]=a[e](t),r.c()),l(r,1),r.m(p.parentNode,p))},i(t){f||(l(r),f=!0)},o(t){i(r),f=!1},d(t){u[e].d(t),t&&$(p)}}}function F(t,e,r){let n,o=p,s=()=>(o(),o=f(m,(t=>r(2,n=t))),m);t.$$.on_destroy.push((()=>o()));let{formEl:i=null}=e,{journeyStore:m}=e;return s(),t.$$set=t=>{"formEl"in t&&r(0,i=t.formEl),"journeyStore"in t&&s(r(1,m=t.journeyStore))},[i,m,n,function(){m?.next(n.step)},function(){m?.reset(),m?.next()},function(t){i=t,r(0,i)}]}class q extends t{constructor(t){super(),e(this,t,F,A,r,{formEl:0,journeyStore:1})}}export{q as default};